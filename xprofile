#!sh

xhost +"SI:localuser:$USER" &

# set up session keyring (pam_keyinit does not work with GDM due to
#   thread issues, fixed in Linux commit 3a50597de)

if have keyctl; then
	if [ "`keyctl rdescribe @s`" = "`keyctl rdescribe @us`" ]; then
		keyctl show -x
		echo "Creating new session keyring"
		if keyctl new_session > /dev/null; then
			keyctl link @u @s
			keyctl show -x
		fi
	fi
fi

# load SSH keys & other credentials

have auca-seed &&
	auca-seed &

# load X settings

[ -f ~/.config/synclient.conf ] &&
	synclient `grep -v "^#" ~/.config/synclient.conf` &

# run startup programs

true
