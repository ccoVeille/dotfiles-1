# ~/.xprofile - X11-specific login script (after ~/.profile)
# vim: ft=sh

if have keyctl; then
	# set up session keyring
	if [ "$(keyctl rdescribe @s)" = "$(keyctl rdescribe @us)" ]; then
		echo "Creating new session keyring"
		if keyctl new_session > /dev/null; then
			keyctl link @u @s
		fi
	fi
	# set up some pointers to environment (for use by cron)
	if have globalenv; then
		globalenv -s \
			+DBUS_SESSION_BUS_ADDRESS	\
			+DISPLAY			\
			+KRB5CCNAME			\
			+SSH_AUTH_SOCK			\
			+XAUTHORITY			\
			+XDG_RUNTIME_DIR		;
	fi
fi

if have auca-seed; then
	auca-seed &
fi

if [ -f ~/.config/synclient.conf ]; then
	synclient $(grep -v "^#" ~/.config/synclient.conf) &
fi

if [ ! "$DESKTOP_SESSION" ]; then
	compton &

	/usr/lib/notify-osd/notify-osd &

	/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &

	if have cinnamon-screensaver; then
		cinnamon-screensaver
	elif have gnome-screensaver; then
		gnome-screensaver
	fi &

	xbindkeys -f ~/.config/xbindkeys/xbindkeysrc &
fi

if [ "$HOSTNAME" = rain ]; then
	if [ "$DESKTOP_SESSION" != gnome ]; then
		mpris mpd notify-idle &
	fi
fi

true
